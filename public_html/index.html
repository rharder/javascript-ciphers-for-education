<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Javascript (De)Ciphers for Education</title>
<link href="js/libs/jquery-ui-1.11.2/jquery-ui.css" rel='stylesheet' type='text/css' />
<script src="js/libs/jquery/jquery.js"></script>
<script src="js/libs/jquery-ui-1.11.2/jquery-ui.js"></script>
<script src="js/libs/highcharts/highcharts.js"></script>
<!--script src="js/libs/object-watch/object-watch.js"></script-->
<script src="js/shift.js"></script>
<script src="js/vigenere.js"></script>


<script language="javascript"><!--


/* ********  L O C A L   F U N C T I O N S  ******** */


function pageInit(){
    
    pageJsInitShiftCipher( shiftCipherJs, 'shiftJsInitContent');
    pageInitVigenereCipher(vigenereCipher, 'vigenereContent');
    //vigenereCipher.key = 'aaaaa';
    
    //$( '#shiftJsInitField legend' ).siblings().slideToggle("slow");
    
    
    // Make all these fieldsets disappear when their legends are clicked
    $(function(){
      $('legend').on('click',function(){
       $(this).siblings().slideToggle("slow");
      });
    });
    
    //loadSecretMessage(0);
}   // end pageInit


var shiftCipher    = Object.create( ShiftCipher );
var shiftCipherJs  = Object.create( ShiftCipher );
var shiftCipherJs2 = Object.create( ShiftCipher );

function pageJsInitShiftCipher( cipher, elId){
    cipher.init( elId );
    
    // Respond to changes to the ciphertext
    $('#ciphertext').on('input propertychange paste',function(){
        cipher.cipherText = $(this).val();
    });
    
    // Glue ShiftCipher to controls
    cipher.addEventListener( "plainTextChanged", function(src){
        $( '#plaintext' )[0].innerHTML = src.plainText;
        $( "#outputLegend" )[0].innerHTML = "Plain Text: Shift Cipher (shift=" + src.originalShift + ")";
    });
    
    // Set up initial cipher text
    cipher.cipherText = $('#ciphertext').text();
  
}   // end pageInitShiftCipher

var vigenereCipher = Object.create( VigenereCipher );
function pageInitVigenereCipher( cipher, elId){
    cipher.init( elId );
    
    // Respond to changes to the ciphertext
    $('#ciphertext').on('input propertychange paste',function(){
        cipher.cipherText = $(this).val();
    });
    
    cipher.addEventListener( "plainTextChanged", function(src){
        $( '#plaintext' )[0].innerHTML = src.plainText;
        $( "#outputLegend" )[0].innerHTML = "Plain Text: Vigenere Cipher (key=" + src.key + ")";
    });
    
    // Set up initial cipher text
    cipher.cipherText = $('#ciphertext').text();
  
}   // end pageInitVigenereCipher

var _secretMessages = [ 
"Gxx ow yg aflg lzw oadv tdmw qgfvwj,\n\
Udaetafy zayz aflg lzw kmf\n\
Zwjw lzwq ugew rggeafy lg ewwl gmj lzmfvwj\n\
Sl 'we tgqk, Yanw 'wj lzw ymf!\n\
Vgof ow vanw, khgmlafy gmj xdsew xjge mfvwj\n\
Gxx oalz gfw zwddmns jgsj!\n\
Ow danw af xsew gj yg vgof af xdsew. Zwq!\n\
Fglzafy usf klgh lzw M.K. Saj Xgjuw!",
        
"qh, l ltxe vpbrphh mje vykny esgfs rj xcrwl, \n\
tpd gegeeg xag snmxu oq ptwgkxxt-slpogrhh pknjw; \n\
lwnzekf i'yi vnipfxf aqh cqiqiw vhh xnobomgi mlvmj oi wnp-sspbv cosnfs - \n\
drw foqi t juqhkgd wlbpgv chw hdzx pow hkgapiw qf - \n\
zlxglhh tpd vstteg egf szygi hlka kn wlx uuqpbv slpxpch. \n\
lhxeumgi tkikg i'yi vjaviw vhh waquwmgi wlrw clrrz \n\
cng jewnj qr gajik erdjm vhusnih ishvlhwl jaopl qf dmk. \n\
''wp, xt mje osgi dhpbtiryl duurbpg epng \n\
i'yi mqpsiw vhh abpd-vaxrt kibihww pktk ituy jvtee, \n\
zlxte qiogr oekm, ou iogn hezne, ipxy; \n\
aqh, pjioi pktk wbneqx, ekfwmgi mlrw k'vh xkqd \n\
wlx jijl nptuilravwxf sdrvviwc hh ssevg, \n\
pxx hwt pc acng egf tryvjeg xag fdgx qf jsw."
];
function loadSecretMessage( index ){
    var text = _secretMessages[index];
    var el = document.getElementById('ciphertext');
    el.value = text;
    //$('#ciphertext').html( text ); // Oddly, this doesn't work after manual input into textarea
    $('#ciphertext').trigger('propertychange');
}

// Init on page load
$( document ).ready(function() {
    pageInit();
});

// --></script>

<style type="text/css">
fieldset {
    margin-top: 1em;
    border-radius: 5px;
}
</style>

</head>
<body>
<fieldset><legend>Secret Messages</legend>
<input type="button" value="Load Secret Message 1" onclick="loadSecretMessage(0);" />
<input type="button" value="Load Secret Message 2" onclick="loadSecretMessage(1);" />
</fieldset>

<!-- Cipher Text -->
<fieldset style="display: inline; width: 45%"><legend>Cipher Text</legend>
    <!--
    Erh hergih xli womiw sr peyklxiv-wmpzivih amrkw; 
    Wyraevh M'zi gpmqfih erh nsmrih xli xyqfpmrk qmvxl sj wyr-wtpmx gpsyhw - 
    erh hsri e lyrhvih xlmrkw Csy lezi rsx hvieqih sj - 
    aliipih erh wsevih erh wayrk lmkl mr xli wyrpmx wmpirgi. 
    Lszivmrk xlivi M'zi glewih xli wlsyxmrk amrh epsrk 
    erh jpyrk qc iekiv gvejx xlvsykl jssxpiww leppw sj emv.
    "Yt, yt xli psrk hipmvmsyw fyvrmrk fpyi 
    M'zi xsttih xli amrh-waitx limklxw amxl iewc kvegi, 
    alivi riziv pevo, sv izir iekpi, jpia; 
    erh, almpi amxl wmpirx, pmjxmrk qmrh M'zi xvsh 
    xli lmkl yrxviwtewwih wergxmxc sj wtegi, 
    tyx syx qc lerh erh xsyglih xli jegi sj Ksh.
    -->    
    <!-- Shift: 4
Sl, M lezi wpmttih xli wyvpc fsrhw sj ievxl, 
Erh hergih xli womiw sr peyklxiv-wmpzivih amrkw; 
Wyraevh M'zi gpmqfih erh nsmrih xli xyqfpmrk qmvxl sj wyr-wtpmx gpsyhw - 
erh hsri e lyrhvih xlmrkw Csy lezi rsx hvieqih sj - 
aliipih erh wsevih erh wayrk lmkl mr xli wyrpmx wmpirgi. 
Lszivmrk xlivi M'zi glewih xli wlsyxmrk amrh epsrk 
erh jpyrk qc iekiv gvejx xlvsykl jssxpiww leppw sj emv.
"Yt, yt xli psrk hipmvmsyw fyvrmrk fpyi 
M'zi xsttih xli amrh-waitx limklxw amxl iewc kvegi, 
alivi riziv pevo, sv izir iekpi, jpia; 
erh, almpi amxl wmpirx, pmjxmrk qmrh M'zi xvsh 
xli lmkl yrxviwtewwih wergxmxc sj wtegi, 
tyx syx qc lerh erh xsyglih xli jegi sj Ksh.
    -->
    <!-- Vigenere: 'cadet'
qh, l ltxe vpbrphh mje vykny esgfs rj xcrwl, 
    tpd gegeeg xag snmxu oq ptwgkxxt-slpogrhh pknjw; 
    lwnzekf i'yi vnipfxf aqh cqiqiw vhh xnobomgi mlvmj oi wnp-sspbv cosnfs - 
    drw foqi t juqhkgd wlbpgv chw hdzx pow hkgapiw qf - 
    zlxglhh tpd vstteg egf szygi hlka kn wlx uuqpbv slpxpch. 
    lhxeumgi tkikg i'yi vjaviw vhh waquwmgi wlrw clrrz 
    cng jewnj qr gajik erdjm vhusnih ishvlhwl jaopl qf dmk. 
    "wp, xt mje osgi dhpbtiryl duurbpg epng 
    i'yi mqpsiw vhh abpd-vaxrt kibihww pktk ituy jvtee, 
    zlxte qiogr oekm, ou iogn hezne, ipxy; 
    aqh, pjioi pktk wbneqx, ekfwmgi mlrw k'vh xkqd 
    wlx jijl nptuilravwxf sdrvviwc hh ssevg, 
    pxx hwt pc acng egf tryvjeg xag fdgx qf jsw.
    -->
    
<textarea id="ciphertext" style="width:100%; " rows="8">
</textarea>
</fieldset>

<!-- Plain Text-->
<fieldset style="display: inline; width: 45%"><legend id="outputLegend">Plain Text</legend>
<textarea id="plaintext" style="width:100%; " rows="8"></textarea>
</fieldset>

<div id="log"></div>
<style type="text/css">
div.content table td  { text-align: center; }
div.content table td div { margin: 1em; text-align: center}
div.content { }
div.shift {width: 100%; margin: 0 auto;  }
div.shift div.controls { display:inline-block; width: 18%; margin: 0; text-align: center; position: relative; top: 50%; transform: translateY(-30%);}
div.shift div.controls div { margin: 0.5em 0; }
div.shift div.controls .slider {width:85%; margin: 0.5em auto }
.chart { display:inline-block; width:37%; height:10em; border: solid #AAA 1px; padding: 0 15px 0px 0; margin: 5px ; border-radius: 5px }
.shiftAlpha, .shiftNum {width:2em; text-align:center; font-size: larger; margin: 2px}
</style>

<fieldset id="shiftJsInitField" style="width: 95%; margin: 1em auto">
<legend>Shift (Caesar) Cipher</legend>
<div id="shiftJsInitContent"  ></div>
</fieldset>

<!--
<fieldset id="shiftJsInitField2" style="width: 95%; margin: 1em auto">
<legend>Shift (Caesar) Cipher (JS Init, 2)</legend>
<div id="shiftJsInitContent2"  ></div>
</fieldset>
-->

<!-- Shift Cipher -->
<!--
<fieldset id="shiftCipherFieldset" style="width: 95%; margin: 1em auto"><legend>Shift (Caesar) Cipher</legend>
<div class="content"  >
  <div class="shift">
    <div class="controls" >
        <div>Original Shift</div>
        <input type="text" id="sc_shiftAlpha" style="width:2em; text-align:center; font-size: larger" value="A" />
        <input type="text" id="sc_shiftNum" style="width:2em; text-align:center; font-size: larger" value="0" />
        <div id="sc_slider" class="slider" >&nbsp;</div>
        <input type="button" value="Guess" onclick="shiftCipher.guess();" />
    </div>
    <div id="sc_freqChart" class="freqChart chart" ></div>
    <div id="sc_dotChart" class="dotChart chart" ></div>
  </div>
</div>
</fieldset>
-->

<!-- Vigenere Square -->
<fieldset id="viginereFieldset" style="width: 95%; margin: 1em auto">
<legend>Vigenere Cipher</legend>
<div id="vigenereContent"  ></div>
</fieldset>
    
    
    
    
</body>
</html>