<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Javascript (De)Ciphers for Education</title>
<link href="js/libs/jquery-ui-1.11.2/jquery-ui.css" rel='stylesheet' type='text/css' />
<script src="js/libs/jquery/jquery.js"></script>
<script src="js/libs/jquery-ui-1.11.2/jquery-ui.js"></script>
<script src="js/libs/highcharts/highcharts.js"></script>
<!--script src="js/libs/object-watch/object-watch.js"></script-->
<script src="js/shift.js"></script>
<script src="js/vigenere.js"></script>


<script language="javascript"><!--
// Backup graph libraries to try:
// http://raphaeljs.com
// https://github.com/eoinmurray/histogram
// https://google-developers.appspot.com/chart/interactive/docs/quick_start

/*
Sl, M lezi wpmttih xli wyvpc fsrhw sj ievxl, 
Erh hergih xli womiw sr peyklxiv-wmpzivih amrkw; 
Wyraevh M'zi gpmqfih erh nsmrih xli xyqfpmrk qmvxl sj wyr-wtpmx gpsyhw - 
erh hsri e lyrhvih xlmrkw Csy lezi rsx hvieqih sj - 
aliipih erh wsevih erh wayrk lmkl mr xli wyrpmx wmpirgi. 
Lszivmrk xlivi M'zi glewih xli wlsyxmrk amrh epsrk 
erh jpyrk qc iekiv gvejx xlvsykl jssxpiww leppw sj emv.
"Yt, yt xli psrk hipmvmsyw fyvrmrk fpyi 
M'zi xsttih xli amrh-waitx limklxw amxl iewc kvegi, 
alivi riziv pevo, sv izir iekpi, jpia; 
erh, almpi amxl wmpirx, pmjxmrk qmrh M'zi xvsh 
xli lmkl yrxviwtewwih wergxmxc sj wtegi, 
tyx syx qc lerh erh xsyglih xli jegi sj Ksh.
 */



/* ********  L O C A L   F U N C T I O N S  ******** */


function pageInit(){
    
    pageInitShiftCipher();
    pageJsInitShiftCipher();
    //pageJsInitShiftCipher2();
    pageInitVigenereCipher();
    
    //$( '#vigenereFieldset legend' ).siblings().slideToggle("slow");
    
    shiftCipher.originalShift = 7;
    
    // Make all these fieldsets disappear when their legends are clicked
    $(function(){
      $('legend').on('click',function(){
       $(this).siblings().slideToggle("slow");
      });
    });
}   // end pageInit


var shiftCipher    = Object.create( ShiftCipher );
var shiftCipherJs  = Object.create( ShiftCipher );
var shiftCipherJs2 = Object.create( ShiftCipher );

function pageJsInitShiftCipher(){
    shiftCipherJs.init( 'shiftJsInitContent' );
    
    // Respond to changes to the ciphertext
    $('#ciphertext').on('input propertychange paste',function(){
        shiftCipherJs.cipherText = $(this).val();
    });
    
    // Glue ShiftCipher to controls
    shiftCipherJs.addEventListener( "plainTextChanged", function(src){
        $( '#plaintext' )[0].innerHTML = src.plainText;
        $( "#outputLegend" )[0].innerHTML = "Plain Text: Shift Cipher JS (shift=" + src.originalShift + ")";
    });
    
    // Set up initial cipher text
    shiftCipherJs.cipherText = $('#ciphertext').text();
  
}   // end pageInitShiftCipher

function pageJsInitShiftCipher2(){
    shiftCipherJs2.init( 'shiftJsInitContent2' );
    
    // Respond to changes to the ciphertext
    $('#ciphertext').on('input propertychange paste',function(){
        shiftCipherJs2.cipherText = $(this).val();
    });
    
    // Glue ShiftCipher to controls
    shiftCipherJs2.addEventListener( "plainTextChanged", function(src){
        $( '#plaintext' )[0].innerHTML = src.plainText;
        $( "#outputLegend" )[0].innerHTML = "Plain Text: Shift Cipher JS2 (shift=" + src.originalShift + ")";
    });
    
    // Set up initial cipher text
    shiftCipherJs2.cipherText = $('#ciphertext').text();
  
}   // end pageInitShiftCipher


function pageInitShiftCipher(){
  
    // Slider control for shift amount
    $( "#sc_slider" ).slider({
          value: 0,
          min: 0,
          max: 25,
          step: 1,
          slide: function( event, ui ) {
            shiftCipher.originalShift = ui.value ;
          }
        });

    // Init chart
    shiftCipher.initFrequencyChart('sc_freqChart');
    shiftCipher.initDotProductChart('sc_dotChart');
    
    // Respond to changes in the Shift Cipher input box
    $('#sc_shiftNum').on('input propertychange paste',function(){
        var s = parseInt( $(this).val() );
        shiftCipher.originalShift = isNaN(s) ? 0 : Math.abs(s % 26);
    });
    $('#sc_shiftAlpha').on('input propertychange paste',function(){
        var c = $(this).val().charCodeAt(0);
        if( c >= 65 && c <= 90 ){
            shiftCipher.originalShift = c - 65;
        } else if( c >= 97 && c <= 122 ){
            shiftCipher.originalShift = c - 97;
        } else {
            shiftCipher.originalShift = 0;
        }
    });
    
    // Respond to changes to the ciphertext
    $('#ciphertext').on('input propertychange paste',function(){
        shiftCipher.cipherText = $(this).val();
    });
    
    // Glue ShiftCipher to controls
    shiftCipher.addEventListener( "plainTextChanged", function(src){
        $( '#plaintext' )[0].innerHTML = src.plainText;
        $( "#outputLegend" )[0].innerHTML = "Plain Text: Shift Cipher (shift=" + src.originalShift + ")";
    });
    shiftCipher.addEventListener( "originalShiftChanged", function(src){
        $( '#sc_shiftAlpha' ).val( String.fromCharCode( src.originalShift+65 ) );
        $( '#sc_shiftNum' ).val( src.originalShift );
        $( "#sc_slider" ).slider({ value: src.originalShift });
    });
    
    // Set up initial cipher text
    shiftCipher.cipherText = $('#ciphertext').text();
    shiftCipher.originalShift = parseInt( $('#sc_shift').val() ) || 0;
    
}   // end pageInitShiftCipher


var vigenereCipher = Object.create( VigenereCipher );
function pageInitVigenereCipher(){
    
    vigenereCipher.initFrequencyChart('v_freqChart_1');
    
    // Slider control for shift amount
    $( "#v_slider_1" ).slider({
          value: 0,
          min: 0,
          max: 26,
          step: 1,
          slide: function( event, ui ) {
            vigenereCipher.originalShift = ui.value ;
          }
        });
    
    // Respond to changes in the Shift Cipher input box
    $('#v_key').on('input propertychange paste',function(){
        vigenereCipher.key = $(this).val();
    });
    
    //Glue ShiftCipher to controls
    vigenereCipher.addEventListener( "plainTextChanged", function(src){
        $( '#plaintext' )[0].innerHTML = src.plainText;
        $( "#outputLegend" )[0].innerHTML = "Plain Text: Vigenere Square Cipher (key=" + src.key + ")";
    });
    vigenereCipher.addEventListener( "keyChanged", function(src){
        $( '#v_key' ).val( src.key );
    });
    
    
    vigenereCipher.key = $('#v_key').val();
    vigenereCipher.cipherText = $('#ciphertext').text();
}


// Init on page load
$( document ).ready(function() {
    pageInit();
});

// --></script>

<style type="text/css">
fieldset {
    margin-top: 1em;
    border-radius: 5px;
}
</style>

</head>
<body>
    <div id="el"></div>

<!-- Cipher Text -->
<fieldset style="display: inline; width: 45%"><legend>Cipher Text</legend>
    <!--
    Erh hergih xli womiw sr peyklxiv-wmpzivih amrkw; 
    Wyraevh M'zi gpmqfih erh nsmrih xli xyqfpmrk qmvxl sj wyr-wtpmx gpsyhw - 
    erh hsri e lyrhvih xlmrkw Csy lezi rsx hvieqih sj - 
    aliipih erh wsevih erh wayrk lmkl mr xli wyrpmx wmpirgi. 
    Lszivmrk xlivi M'zi glewih xli wlsyxmrk amrh epsrk 
    erh jpyrk qc iekiv gvejx xlvsykl jssxpiww leppw sj emv.
    "Yt, yt xli psrk hipmvmsyw fyvrmrk fpyi 
    M'zi xsttih xli amrh-waitx limklxw amxl iewc kvegi, 
    alivi riziv pevo, sv izir iekpi, jpia; 
    erh, almpi amxl wmpirx, pmjxmrk qmrh M'zi xvsh 
    xli lmkl yrxviwtewwih wergxmxc sj wtegi, 
    tyx syx qc lerh erh xsyglih xli jegi sj Ksh.
    -->    
    <!-- Shift: 4
    Sl, M lezi wpmttih xli wyvpc fsrhw sj ievxl, 
Erh hergih xli womiw sr peyklxiv-wmpzivih amrkw; 
Wyraevh M'zi gpmqfih erh nsmrih xli xyqfpmrk qmvxl sj wyr-wtpmx gpsyhw - 
erh hsri e lyrhvih xlmrkw Csy lezi rsx hvieqih sj - 
aliipih erh wsevih erh wayrk lmkl mr xli wyrpmx wmpirgi. 
Lszivmrk xlivi M'zi glewih xli wlsyxmrk amrh epsrk 
erh jpyrk qc iekiv gvejx xlvsykl jssxpiww leppw sj emv.
"Yt, yt xli psrk hipmvmsyw fyvrmrk fpyi 
M'zi xsttih xli amrh-waitx limklxw amxl iewc kvegi, 
alivi riziv pevo, sv izir iekpi, jpia; 
erh, almpi amxl wmpirx, pmjxmrk qmrh M'zi xvsh 
xli lmkl yrxviwtewwih wergxmxc sj wtegi, 
tyx syx qc lerh erh xsyglih xli jegi sj Ksh.
    -->
    <!-- Vigenere: 'cadet'
        Ri, M muyf wqcsqii nkf wzloz fthgt sk ydsxm, 
    Uqe hfhffh ybh tonyv pr quxhlyyu-tmqphsii qlokx; 
    Mxoaflg J'zj wojqgyg bri drjrjx wii yopcpnhj nmwnk pj xoq-ttqcw dptogt - 
    esx gprj u kvrilhe xmcqhw Dix ieay qpx ilhbqjx rg - 
    amyhmii uqe wtuufh fhg tazhj imlb lo xmy vvrqcw tmqyqdi. 
    Miyfvnhj uljlh J'zj wkbwjx wii xbrvxnhj xmsx dmssa 
    doh kfxok rs hbkjl fsekn wivtoji jtiwmixm kbpqm rg enl.
    "Xq, yu nkf pthj eiqcujszm evvscqh fqoh 
    J'zj nrqtjx wii bcqe-wbysu ljcjixx qlul juvz kwuff, 
    amyuf rjphs pfln, pv jpho ifaof, jqyz; 
    bri, qkjpj qlul xcofry, flgxnhj nmsx L'wi ylre 
    xmy kjkm oquvjmsbwxyg teswwjxd ii ttfwh, 
    qyy ixu qd bdoh fhg uszwkfh ybh gehy rg Ktx.
    -->
    
<textarea id="ciphertext" style="width:100%; " rows="8">
Sl, M lezi wpmttih xli wyvpc fsrhw sj ievxl, 
Erh hergih xli womiw sr peyklxiv-wmpzivih amrkw; 
Wyraevh M'zi gpmqfih erh nsmrih xli xyqfpmrk qmvxl sj wyr-wtpmx gpsyhw - 
erh hsri e lyrhvih xlmrkw Csy lezi rsx hvieqih sj - 
aliipih erh wsevih erh wayrk lmkl mr xli wyrpmx wmpirgi. 
Lszivmrk xlivi M'zi glewih xli wlsyxmrk amrh epsrk 
erh jpyrk qc iekiv gvejx xlvsykl jssxpiww leppw sj emv.
"Yt, yt xli psrk hipmvmsyw fyvrmrk fpyi 
M'zi xsttih xli amrh-waitx limklxw amxl iewc kvegi, 
alivi riziv pevo, sv izir iekpi, jpia; 
erh, almpi amxl wmpirx, pmjxmrk qmrh M'zi xvsh 
xli lmkl yrxviwtewwih wergxmxc sj wtegi, 
tyx syx qc lerh erh xsyglih xli jegi sj Ksh.
</textarea>
</fieldset>

<!-- Plain Text-->
<fieldset style="display: inline; width: 45%"><legend id="outputLegend">Plain Text</legend>
<textarea id="plaintext" style="width:100%; " rows="8"></textarea>
</fieldset>

<div id="log"></div>
<style type="text/css">
div.content table td  { text-align: center; }
div.content table td div { margin: 1em; text-align: center}
div.content { }
div.shift {width: 100%; margin: 0 auto; }
div.shift div.controls { display:inline-block; width: 18%; margin: 0 auto; text-align: center; position: relative; top: 50%; transform: translateY(-50%);}
div.shift div.controls div { margin: 0.5em 0;}
div.shift div.controls .slider {width:85%; margin: 0.5em auto }
.chart { display:inline-block; width:37%; height:10em; border: solid #AAA 1px; padding: 0 15px 0px 0; margin: 5px ; border-radius: 5px }
.shiftAlpha, .shiftNum {width:2em; text-align:center; font-size: larger; margin: 2px}
</style>

<fieldset id="shiftJsInitField" style="width: 95%; margin: 1em auto">
<legend>Shift (Caesar) Cipher (JS Init)</legend>
<div id="shiftJsInitContent"  ></div>
</fieldset>

<fieldset id="shiftJsInitField" style="width: 95%; margin: 1em auto">
<legend>Shift (Caesar) Cipher (JS Init, 2)</legend>
<div id="shiftJsInitContent2"  ></div>
</fieldset>

<!-- Shift Cipher -->
<fieldset id="shiftCipherFieldset" style="width: 95%; margin: 1em auto"><legend>Shift (Caesar) Cipher</legend>
<div class="content"  >
  <div class="shift">
    <div class="controls" >
        <div>Original Shift</div>
        <input type="text" id="sc_shiftAlpha" style="width:2em; text-align:center; font-size: larger" value="A" />
        <input type="text" id="sc_shiftNum" style="width:2em; text-align:center; font-size: larger" value="0" />
        <div id="sc_slider" class="slider" >&nbsp;</div>
        <input type="button" value="Guess" onclick="shiftCipher.guess();" />
    </div>
    <div id="sc_freqChart" class="freqChart chart" ></div>
    <div id="sc_dotChart" class="dotChart chart" ></div>
  </div>
</div>
</fieldset>

<!-- Vigenere Square -->
<fieldset id="vigenereFieldset" style="width: 95%"><legend>Vigenere Square Cipher</legend>
<div class="content"  >
    
    <div>
        Key: <input type="text" id="v_key" style="width:10em; margin-right: 2em" value="A" />
        Key Length: <input type="text" id="v_keyLength" style="width:3em; margin-right: 2em" value="1" />
        <input type="button" value="Guess Key Length" onclick="vigenereCipher.solve();" />
    </div>
    <div class="shift">
        <div class="controls" >
            <div>Key Character <span class="v_keyChar_1">1</span></div>
            <input type="text" id="v_keyChar_1" style="width:2em; text-align:center; font-size: larger" value="A" />
            <div id="v_slider_1" class="slider" >&nbsp;</div>
        </div>
        <div id="v_freqChart_1" class="freqChart chart" ></div>
        <div id="v_dotChart_1" class="dotChart chart" ></div>
    </div>
</div>
    
    
</fieldset>



</body>
</html>